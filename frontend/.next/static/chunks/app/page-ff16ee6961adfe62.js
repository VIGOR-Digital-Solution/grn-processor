(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2512:function(e,t,l){Promise.resolve().then(l.bind(l,2225))},2225:function(e,t,l){"use strict";var i=l(7437),a=l(932),n=l(3191),s=l(5524),o=l(8472),d=l(2265);let c=e=>{let{onClick:t,disabled:l,children:a}=e;return(0,i.jsx)("button",{onClick:t,disabled:l,className:"px-4 py-2 font-bold text-white rounded ".concat(l?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-700"," mr-2"),children:a})},u=e=>{let{backendUrl:t}=e,[l,o]=(0,d.useState)(""),{data:u}=(0,a.a)({queryFn:()=>r(t),queryKey:["settings"],enabled:!!t}),m=(0,n.NL)(),{mutate:b}=(0,s.D)({mutationFn:e=>v(t,null==e?void 0:e.title,null==e?void 0:e.value),onSettled:async()=>{await m.invalidateQueries({queryKey:["settings"]}),await m.invalidateQueries({queryKey:["logs"]})}});return(0,d.useEffect)(()=>{if(u){var e,t;o(null===(t=u.data)||void 0===t?void 0:null===(e=t.find(e=>(null==e?void 0:e.title)==="file_location"))||void 0===e?void 0:e.value)}},[u]),(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Settings"}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{htmlFor:"csvLocation",className:"block mb-2",children:"CSV File Location:"}),(0,i.jsx)("input",{id:"csvLocation",type:"text",value:l,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border rounded mb-4"})]}),(0,i.jsx)(c,{onClick:()=>{b({title:"file_location",value:l})},children:"Save Settings"})]})};function r(e){return o.Z.get("".concat(e,"/settings"))}function v(e,t,l){return o.Z.put("".concat(e,"/settings/").concat(t),{value:l})}t.default=()=>{var e,t,l,m,b;let[x,h]=(0,d.useState)(""),[f,g]=(0,d.useState)(!1),{data:y}=(0,a.a)({queryFn:()=>o.Z.get("".concat(x,"/logs")),queryKey:["logs"],refetchInterval:1e3,enabled:!!x}),{data:N}=(0,a.a)({queryFn:()=>r(x),queryKey:["settings"],enabled:!!x});(0,d.useEffect)(()=>{h("".concat(window.location.protocol,"//").concat(window.location.hostname,":4001"))},[]);let p=(0,n.NL)(),{mutate:j}=(0,s.D)({mutationFn:e=>v(x,null==e?void 0:e.title,null==e?void 0:e.value),onSettled:async()=>{await p.invalidateQueries({queryKey:["settings"]}),await p.invalidateQueries({queryKey:["logs"]})}}),w=null==N?void 0:null===(t=N.data)||void 0===t?void 0:null===(e=t.find(e=>(null==e?void 0:e.title)==="state"))||void 0===e?void 0:e.value,S=null==N?void 0:null===(m=N.data)||void 0===m?void 0:null===(l=m.find(e=>(null==e?void 0:e.title)==="file_location"))||void 0===l?void 0:l.value,k=null==y?void 0:null===(b=y.data)||void 0===b?void 0:b.map(e=>({...e,timestamp:new Date((null==e?void 0:e.timestamp)*1e3).toLocaleString()}));return(0,i.jsxs)("div",{className:"p-4 max-w-4xl mx-auto",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"GRN Processor for JUKI IFS-NX System"}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)(c,{onClick:()=>g(!f),children:f?"Back to Main":"Settings"}),!f&&(0,i.jsx)(c,{onClick:()=>{"active"===w?j({title:"state",value:"inactive"}):j({title:"state",value:"active"})},disabled:!w&&!S,children:"active"===w?"OFF":"ON"})]}),f?(0,i.jsx)(u,{backendUrl:x}):(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"mb-4",children:["Current CSV Location: ",S]}),(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Process Logs:"}),(0,i.jsx)("div",{className:"bg-gray-100 p-2 rounded h-64 overflow-y-auto",children:null==k?void 0:k.map(e=>(0,i.jsxs)("p",{className:"mb-1",children:["[",null==e?void 0:e.timestamp,"] ",null==e?void 0:e.message]},null==e?void 0:e.id))})]})]})]})}}},function(e){e.O(0,[832,260,971,23,744],function(){return e(e.s=2512)}),_N_E=e.O()}]);